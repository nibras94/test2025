<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-head-title">Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© | [Ø§Ø³Ù… Ù…ÙˆÙ‚Ø¹Ùƒ]</title> 
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>

    <style>
        /* ØªÙ… ØªÙˆØ­ÙŠØ¯ Ø§Ù„Ø³ØªØ§ÙŠÙ„ Ù‡Ù†Ø§ Ù„ÙŠØ¹ØªÙ…Ø¯ ÙƒÙ„ÙŠØ§Ù‹ Ø¹Ù„Ù‰ Ù…ØªØºÙŠØ±Ø§Øª style.css ÙˆÙƒÙ„Ø§Ø³Ø§Øª Tailwind */
        .sidebar { 
            background-color: var(--color-background-secondary); 
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); 
            border: 1px solid var(--color-border-dark);
        }
        .text-accent { color: var(--color-accent-teal) !important; }
        .text-primary-color { color: var(--color-text-primary) !important; }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ (Topic Cards) ÙˆØ§Ù„Ù…ÙˆØ§Ø¯ (Subject Cards) */
        .topic-card {
            transition: transform 0.2s, border-color 0.2s;
            border-left: 5px solid transparent; /* Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø¨Ø±Ø§Ø² Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ */
            height: 100%;
            background-color: var(--color-background-secondary) !important;
            color: var(--color-text-primary) !important;
        }
        .topic-card:hover {
            transform: translateY(-3px);
            border-left-color: var(--color-accent-teal);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }
        .btn-custom-back {
            color: var(--color-accent-teal) !important;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <header class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <h2 id="page-main-title" class="navbar-brand text-accent fs-4 fw-bold">Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</h2>
            </div>
    </header>

    <main class="container mt-4">
        
        <div class="sidebar p-4 p-md-5">
            <div class="d-flex justify-content-between align-items-center border-bottom border-gray-600 pb-3 mb-4">
                
                <a id="dynamic-back-link" href="courses.html" class="btn btn-link btn-custom-back p-0">
                    Â« Ø§Ù„Ø¹ÙˆØ¯Ø©
                </a>
                
                <h1 id="current-content-title" class="fs-4 fw-bold text-primary-color">...</h1>
            </div>

            <div id="content-list" class="row row-cols-1 row-cols-md-2 g-4">
                <div class="col-12 text-center text-secondary p-5" id="loading-message">
                    Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰...
                </div>
            </div>
            
        </div>
        
    </main>

    <footer class="text-center py-3 mt-5" style="background-color: #0d1736; border-top: 1px solid #374151;">
        <small class="text-secondary">&copy; 2025 Ù…Ù†ØµØ© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</small>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script>
        // ******************************************************
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ - ØªÙ… Ø­ØµØ± Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø§Ù„Ø¹Ù„ÙˆÙ… Ù‡Ù†Ø§
        // ******************************************************
        const COURSE_DATA = {
            'primary6': {
                id: 'primary6',
                name: 'Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ',
                subjects: {
                    'social': {
                        id: 'social',
                        name: 'Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª',
                        icon: 'ğŸ“š',
                        topics: [
                            { id: 'taareef', name: 'Ø§Ù„ØªØ¹Ø§Ø±ÙŠÙ ÙˆØ§Ù„Ù…ØµØ·Ù„Ø­Ø§Øª', url: 'primary6/social/course_page.html' }, 
                            { id: 'taaleel', name: 'Ø§Ù„ØªØ¹Ø§Ù„ÙŠÙ„ ÙˆØ§Ù„ØªÙØ³ÙŠØ±Ø§Øª', url: 'primary6/social/social_definitions.html' },
                            { id: 'dates', name: 'Ø§Ù„Ø´Ø®ØµÙŠØ§Øª ÙˆØ§Ù„ØªÙˆØ§Ø±ÙŠØ®', url: 'primary6/social/social_reasons.html' },
                        ]
                    },
                    // **ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡: Ø­ØµØ± Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ Ù„Ù€ 2 ÙÙ‚Ø·**
                    'science': {
                        id: 'science',
                        name: 'Ø§Ù„Ø¹Ù„ÙˆÙ…',
                        icon: 'ğŸ”¬',
                        topics: [
                            { id: 'taareef', name: 'Ø§Ù„ØªØ¹Ø§Ø±ÙŠÙ ÙˆØ§Ù„Ù…ØµØ·Ù„Ø­Ø§Øª', url: 'primary6/science/course_page.html' }, 
                            { id: 'taaleel', name: 'Ø§Ù„ØªØ¹Ø§Ù„ÙŠÙ„ ÙˆØ§Ù„Ù…Ù‚Ø§Ø±Ù†Ø§Øª', url: 'primary6/science/science_ØªØ¹Ø§Ù„ÙŠÙ„.html' },
                        ]
                    },
                    'math': { id: 'math', name: 'Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª', icon: 'ğŸ“', topics: [{ id: 'laws', name: 'Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† ÙˆØ§Ù„Ù…Ù„Ø®ØµØ§Øª', url: 'primary6/math/laws.html' }] },
                    'islamic': { id: 'islamic', name: 'Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©', icon: 'ğŸ•Œ', topics: [{ id: 'hifdh', name: 'Ø§Ù„Ø­ÙØ¸ÙŠØ§Øª ÙˆØ§Ù„ØªØ¹Ø§Ù„ÙŠÙ…', url: 'primary6/islamic/hifdh.html' }] },
                    'arabic': { id: 'arabic', name: 'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', icon: 'âœï¸', topics: [{ id: 'qawaed', name: 'Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ ÙˆØ§Ù„Ø¥Ø¹Ø±Ø§Ø¨', url: 'primary6/arabic/qawaed.html' }] },
                    'english': { id: 'english', name: 'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©', icon: 'ğŸ‡¬ğŸ‡§', topics: [{ id: 'grammar', name: 'Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ ÙˆØ§Ù„Ù…ÙØ±Ø¯Ø§Øª', url: 'primary6/english/grammar.html' }] }
                }
            },
            'middle3': {
                id: 'middle3',
                name: 'Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ù…ØªÙˆØ³Ø·',
                subjects: { /* ... */ }
            }
        };

        // ******************************************************
        // Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø·
        // ******************************************************

        function getUrlParams() {
            const params = {};
            const queryString = window.location.search.substring(1);
            const regex = /([^&=]+)=([^&]*)/g;
            let m;
            while (m = regex.exec(queryString)) {
                params[decodeURIComponent(m[1])] = decodeURIComponent(m[2]);
            }
            return params;
        }

        function renderSubjects(courseId, courseData) {
            const listContainer = document.getElementById('content-list');
            
            document.getElementById('page-main-title').textContent = `${courseData.name}: Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯`;
            document.getElementById('page-head-title').textContent = `${courseData.name}: Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯`;
            document.getElementById('current-content-title').textContent = 'Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©:';

            const backLinkContainer = document.getElementById('dynamic-back-link');
            backLinkContainer.href = 'courses.html'; 
            backLinkContainer.textContent = `Â« Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±Ø§Ø­Ù„`;
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ù„Ù…ÙˆØ§Ø¯ (Ø´Ø¨ÙƒØ© 3x3)
            listContainer.className = 'row row-cols-1 row-cols-md-3 g-4';
            
            let htmlContent = '';
            for (const subjectId in courseData.subjects) {
                const subject = courseData.subjects[subjectId];
                // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹
                const link = `course_page.html?course_id=${courseId}&subjectId=${subjectId}`; 
                
                htmlContent += `
                    <div class="col">
                        <a href="${link}" class="card topic-card h-100 p-3 text-decoration-none">
                            <div class="card-body">
                                <h5 class="card-title text-accent fs-5 fw-bold">${subject.icon} ${subject.name}</h5>
                                <p class="card-text text-secondary">Ø§Ù†Ù‚Ø± Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªØ¹Ø§Ø±ÙŠÙ ÙˆØ§Ù„Ø£Ø³Ø¦Ù„Ø©.</p>
                            </div>
                        </a>
                    </div>`;
            }
            listContainer.innerHTML = htmlContent;
        }

        function renderTopics(courseId, subjectId) {
            const listContainer = document.getElementById('content-list');
            const courseData = COURSE_DATA[courseId];
            const subjectData = courseData ? courseData.subjects[subjectId] : null;

            if (!subjectData) {
                 listContainer.innerHTML = '<div class="col-12 text-center text-danger p-5">Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.</div>';
                 return;
            }
            
            document.getElementById('page-main-title').textContent = `${subjectData.name} - ${courseData.name}`;
            document.getElementById('page-head-title').textContent = `${subjectData.name}: Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹`;
            document.getElementById('current-content-title').textContent = 'Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ø®Øµ Ø£Ùˆ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©:';

            // ØªØ­Ø¯ÙŠØ¯ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯
            const backLinkContainer = document.getElementById('dynamic-back-link');
            const backLinkUrl = `course_page.html?course_id=${courseId}`; // Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯ Ù„Ù†ÙØ³ Ø§Ù„Ù…Ø±Ø­Ù„Ø©
            backLinkContainer.href = backLinkUrl;
            backLinkContainer.textContent = `Â« Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ù…ÙˆØ§Ø¯ ${courseData.name}`;

            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ (Ø´Ø¨ÙƒØ© 2x2)
            listContainer.className = 'row row-cols-1 row-cols-md-2 g-4';
            
            let htmlContent = '';
            subjectData.topics.forEach(topic => {
                // Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù„Ù‰ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø«Ø§Ø¨Øª ÙÙŠ Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„ÙØ±Ø¹ÙŠ (Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ø¬Ù„Ø¯ÙŠÙ†)
                const fullUrl = topic.url; 

                htmlContent += `
                    <div class="col">
                        <a href="${fullUrl}" class="card topic-card h-100 p-3 text-decoration-none">
                             <div class="card-body">
                                <h5 class="card-title text-accent fs-5 fw-bold">ğŸ“„ ${topic.name}</h5>
                            </div>
                        </a>
                    </div>`;
            });

            listContainer.innerHTML = htmlContent;
        }

        function initializePage() {
            // **Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø³ÙŠØ¹Ù…Ù„ ÙÙ‚Ø· Ù…Ø¹ ÙˆØ¬ÙˆØ¯ script.js Ø§Ù„Ø°ÙŠ ÙŠØ³ØªØ¯Ø¹ÙŠ Firebase Auth**
            
            const params = getUrlParams();
            const courseId = params.course_id;
            const subjectId = params.subjectId;
            
            const loadingMessage = document.getElementById('loading-message');
            if (loadingMessage) loadingMessage.remove(); 

            if (!courseId) {
                // ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ© Ù…Ø­Ù…ÙŠØ© ÙÙŠ script.js
                window.location.href = 'courses.html';
                return; 
            }
            
            const courseData = COURSE_DATA[courseId];
            if (!courseData) {
                 document.getElementById('page-main-title').textContent = 'Ø®Ø·Ø£';
                 document.getElementById('current-content-title').textContent = 'Ø§Ù„Ù…Ø±Ø­Ù„Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©.';
                 return;
            }

            if (subjectId) {
                // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¶ÙŠØ¹ (Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù„Ø«)
                renderTopics(courseId, subjectId);
            } else {
                // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯ (Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù†ÙŠ)
                renderSubjects(courseId, courseData);
            }
        }

        document.addEventListener('DOMContentLoaded', initializePage);
    </script>
</body>
</html>